Index: README.md
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>ТЕСТ ХУЕСТ БЛЯТЬ\n\n\n# arNote\n1. Сервис хранения желаний, планирования трат.\n2. Сервис анализа инвестиций\n3. Сервис финансового планирования\n\n# Сервис хранения желаний\nДоступен в сайдбаре в пункте \"Список желаний\". Предоставляет возможность добавления желаний (они же  - цели, финансовые планы, хотелки). Добавление организовано для каждого конкретного пользователя. Желание представляет собой финансовую цель с наименованием, подробным описанием, ссылкой URL, где можно посмотреть или купить, стоимостью и приоритетом. Желания представлены в общей таблице. Можно фильтровать по приоритету (Первичный или общий) и сортировать по цене или имени. Желания можно удалять и редактировать. \nСуществует возможность задать зарплату (причем задается и зарплата и реальная сумма, сколько пользователь может тратить в месяц) и тем самым получить расчет, сколько времени потребуется на реализацию всех задач / приоритетных.\nТак же в меню фильтрация добавлен отдельный пункт \"помесячная группировка\". Этот пункт позволяет задать альтернативную группировку, с помощью которой система сортирует желания по месяцам. Можно двигать желания туда-сюда и понимать, сколько всего в том или ином месяце вы собираетесь потратить. \n\n# Сервис анализа инвестиций \nСервис, который я выкатил в прод только 10.02.2021. Сервис \"ходит\" с помощью REST-запросов в API Московской биржи и буржуйские API (AlphaAdvantag, Yahoo), запрашивает оттуда все доступные данные: котировки акции с промежутком 15 минут, описание бумаги, купоны, дивиденды, исторические данные по годам. Можно добавлять бумаги по тикеру, добавлять даты и объем покупки. После чего можно мониторить рост бумаги, прогнозировать потребные затраты в зависимости от текущего дохода и желаемого, получать календарь ближайших выплат. \n \n\n# Долгосрочное планирование бюджетов и трат\nСервис, который позволяет планировать сроки выплат кредитов и рассчитывать свои финансовые планы. Грубо говоря - сколько лет понадобится на реализацию тех или иных личных проектов с учетом каждодневных трат, вашей зарплаты и платежам по кредитам.\n\n\n# URL сервиса\nhttp://84.201.163.22:8080/\n\n# Запуск на проде\n-Dspring.profiles.active=prod\n\n# Сборка на локале\n ~/Maven/bin/mvn package -P local\n\n# Что сделали:\n* Теперь если выбрана дата по которой нет продаж - выходной или праздник - бумагу добавить нельзя.\n* Еще раз проверить, что точно работает изменение по месяацам\n\n\n# Баги\n\n## Максимальный приоритет:\n\n* Я хочу менять размер выплат по кредиту после досрочных погашений\n* Большой РЕФАКТОРИНГ!\n* Опять не работает изменение помесячного приоритета\n* Тесты для изменения помесячного приоритета\n* Проверить кейс - бумага была в Плане, а я решил ее купить - как онО отыграет?\n* НоваяТиньковскаяДельта - для иностранных бумаг\n* Опять при протухании токена, если идешь на какое-нибудь /finplaning ни фига не открывается\n* Подключить Бинанс АПИ\n* ТЕЛЕГРАМ-БОТ: сохранять режим отображения (Мобильный / Десктоп)\n* ТЕЛЕГРАМ-БОТ: Фин-Планы\n* ТЕЛЕГРАМ-БОТ: Месячный приоритет\n* ТЕЛЕГРАМ-БОТ: Поиск желаний\n* ТЕЛЕГРАМ-БОТ: Отображение всех желаний\n* ТЕЛЕГРАМ-БОТ: URL и Дескрипшн в редактирование желаний\n* ТЕЛЕГРАМ-БОТ: Редактирование через Кнопки (CallBacks + LayOuts)\n* getClosePositionForTomorrow - в ArNoteUtils - а если вчера было воскресенье?????\n* Отчеты и структура портфеля по инвестированию(типа каких бумаг больше - акций или облигаций)\n* Если вместо \".\" указать \",\" в сумме при добавлении бумаги - запрос валится. Нужно валидировать это.\n* Подсчет дельты для наших и иностранных бумаг - может унифицировать и вынести в Утилс?\n* Календарь покупок с фильтром / поиском по бумагам\n* Если я бумагу удаляю, покупки по ней тоже удаляются? Может быть, сделать статус (ПРОДАНА?)\n* Нужно продумать комментарии к бумаге и как отдельно выделять бумаги, который я коплю на налог (цвет, флажк, группы?)\n* Почему-то при поиске бумаги делается 2 одинаковых запроса к альфа-адвантедж \n* Место, где я стучусь в буржуйские АПИ и если они не отвечают, возвращаю null - не красиво сделано. Надо порефакторить, подумать как исправить. Может быть, сделать типа запрос-пинг. И если он вернул false, то просто не дергать все остальные запросы буржуйские.\n* Обновить данные по бумагам\n* Вообще надо решить вопрос со столбцами Минимальный Лот / Куплено. Например для ПЛАН не нужно показывать сколько куплено. Это путает. Нужно подумать как это лучше сделать.\n* Когда стучишься из под корпоративной сети, он не может достучаться до Яху - нужен серт. И валится весь консолидированный запрос. Такого быть не должно. Такие бумаги по которым запрос свалился надо уметь просто пропускать.\n* Вот я добавляю продажу по бумаге. А в какой валюте сумма?????\n* Уже нужен фильтр/поиск по бумагам\n* Я хочу видеть формулу расчета дельты прямо на фронте\n* Нужно убрать доступы к БД из Гита. Сменить пароли в удаленной БД. Локальные все эти пароли, адреса хранить на локальной машине только.\n* Свечи с буржуйских сайтов\n* Я хочу либо отключать пока предыдущих лет в Фин-планах, либо регулировать диапазон\n\n\n## Ближайшие срочные мелкие косяки и баги:\n\n* Я хочу видеть баланс портфеля при работе с бумагами в основном окне (сколько куплено, динамика)\n* Нужно будет сделать где-то на фронте кнопочку, по которой отображается подсвет формул расчета\n* Мое самописное кеширование попробовать запихать в аннотацию \n* В классе com.antonromanov.arnote.model.investing.response.DeltaRs (+ И НА ФРОНТЕ!) переименовать поля deltaInRubles, tinkoffDelta, tinkoffDeltaPercent согласно их реально назначения\n* Кнопка \"Доходы\" должна быть заблочена если идет отрицательная прибыль или купленых бумаг нет\n* С ArNoteUtils надо что-то делать - там под 1000 строк уже\n* Календарь заблочен должен быть если нет купленых бумаг\n* Я хочу посмотреть деталку по бумаге и свои покупки по ней.\n* Бага: я решил добавить бумагу. Произошел поиск на фронте, заполнился список, а потом второй раз я захожу добавлять новую бумагу - а там опять этот же заполненный список. Его надо чистить!\n* Я хочу чтобы тот факт, что фильтр включен по бумагам как то отображалось на фронте\n* возможно есть какой-то компонент с драг-энд-дропом. Может его использовать в планировании по месяцам? Так же туда может быть добавить филтры и поиск, управление сортировкой? Ну и вообще это надо комплексно переделывать. Сейчас этим пользоваться откровенно не удобно\n* Я хочу чтобы где-то (подумать как лучше) отображалось: сколько у меня валюты / сколько акций / сколько облиг / сколько ETF\n* Я хочу, чтобы мы умели точно определять отрицательный баланс портфеля и это как как-то отображалось каким-то алармом и не работал при этом прогноз дохода\n* Я хочу видеть курс бакса в основном окне\n* По ETF надо не 0 отображать в дивах, а что-то другое. И соответственно с бека возможно не надо этот блок передавать вообще?\n* Я хочу видеть отчеты. Например, такие: диаграмма состава буржуйских бумаг к российским, диаграмма сколько процентов у меня акций, сколько облиг, сколько ETF, баланс портфеля по годам и месяцам.\n* Слишком долго грузятся инвестиции. Надо пихать в поток \n* Группы\n* ФРОНТ: При изменении кол-ва записей на странице любое добавление рушит табличку - она приходит пустой.\n* Прогресс бар при загрузке бумаг\n* Графики бумаг\n* Статус кеша при загрузке бумаг\n* Статус кешей/мап при подсчете консолидированной таблице по фин-планам на фронте\n* Почему я все время должен отключать поиск?\n* Все модалБоксы на фронте почикать\n* Все на фронте на асинхрон\n* Консолидированная табла по фин-планам в потоке с прогрессбаром на фронте\n* Надпись ArNote в заголовке для мобилки убрать - не лезет\n* Не пишется дата создания при создании желания\n* Разные помники для Прома и Дева\n* Возможность переключения валюты текущей (для все бумаг и всех показателей должна быть одна валюта - все рассчеты в одной валюте)\n* Разобраться с фигней, когда переходишь на страничку - а она не отображается (выявить причины: не поднялся сервис, протух токен)\n* Вынести пользовательские методы в отдельный контроллер и сделать отдельный метод для сохранения режима получения, отдельный для получения\n* Придумать и написать тест для перемещения\n* Сделать бейдж NEW в помесячной группировке для только что добавленных желаний\n* Сделать сохранение фильтрации и сортировки для помесячной группировки\n* Сделать поиск в помесячной группировке\n* Надо убрать РеспонсЭнтити и возвращать нормальные ДТО-объекты, а не этот пиздец\n* Сделать какой-то учет текущей суммы\n* Перестали сохранять последнюю операцию. Почему?\n* Почему бы не кешировать поиск (речь о ценных бамагах и вкладке Инвестиции)(подумать как)? И вообще подумать на счет поиска. Варианты: \n\n1) С кнопкой.\n    1.1 самый тупой - кнопка внизу\n    1.2 посложнее - ставим новый Ангуляр и пробуем новые поля с кнопкой\n\n\n2) кеш поиска (поисковых запросов) + блочим поле пока ответ не придет / либо очередь запросов.\n* Для инвестиций: подумать над отображением графиков\n* Для инвестиций: подумать над добавлением алармов (и сбросов их в инсту)\n* Для инвестиций: подумать над добавлением алармов с информацией об удачном времени покупки / продажи, например о том, что бумага идет к ее историческому минимуму / перешла его, пробила новый (то же самое по максимуму). И не плохо было бы вообще показывать где-то исторический минимум / максимум. Например сделать деталку по бумаге.\n* Сделать отображение текущих режимов сортировки и фильтрации\n* Вынести вкладку помесячной группировки на сайдбар\n* Добавить вкладку групп (так же вынести в сайдбар)\n* Написать тесты\n* Сейчас мы считаем просто сколько вложили за все время и делим на купоны / рост / дивы за все время. А по хорошему надо считать или за прошлый год или вообще какую-то сложную логику по годам или вообще разный подсчет выдавать, например: всего / по последнему году / по среднему / по минимальному / по максимальному.\n* Прокинуть интерцепторы\n* Общий ЭксепшнХендлер\n* Сделать само-отключение поиска\n* Нормальный DNS для сайта\n* Показывать более развернутую статистику: реализованное и все такое\n* При щелчке на желании показывать в каком оно месяце при всех видах отображения\n* Надо организовать еще списки подсчетов с исключением определенных записей (типа микро-сметы)\n* Надо чтобы нельзя было добавлять одинаковые желания\n* Написать статью на AntonRomanov.com о сервисе\n* Починить фигню с тем что надо щелкнуть, чтобы табличка подгрузилась\n* Починить фигню с 401-й странице\n* Решить тему с протухающим токеном\n* Подсмотреть как сделан шедулинг проверки протухания токена с выводом алерта.\n* Фавикон\n* Выделение и перемещение по месяцам нескольких желаний\n* Кнопочки Реализовать / Удалить / Редактировать при нажатии на желание в помесячно-групповом режиме\n* Кнопочки \"Вернуться в табличный режим\" и \"Обновить\" заменить для мобилы\n* Избавиться от $Do и всего такого.\n* Провести общий большой рефакторинг\n* Пагинация\n* Фин-планы слишком долго отвечают. Надо разобраться почему?\n* Опять не работает поиск\n* Зачем в выдаче списка желаний для каждого желания блок user ????\n* По-хорошему надо хранить покупки в разных валютах. Вдруг курс как-то изменится. \n* Не добавляются буржуйские бумаги\n* Как быть - если ценник бумаги в баксах и нужно задать ценник на конкретную дату? В каких единицах я задаю на фронте?\n* Не запрашиваются цены бумаги по дате\n* Нужно сделать расчет для 120 000 в месяц, 200 000 руб.\n* TRCN - не нашли цену в LAST - берем откуда-то еще\n* При поиске на мобилке соседняя кнопка почему-то загорается то же красным?\n* Порешать автовыключение-режима поиска уже\n* Добавить мапстракт\n* Привести всю тему с ошибками, их перехватом и выдачей на фронт к одному виду по всему проекту\n* В календаре отображаются дивы однотипные по 4 раза. Одно и то же. Почему?\n* Менять версии в помнике, чтобы скрипт как-то умел их подхватывать и чтобы они в ГИТе отображались\n* Надо ходить в историю и смотреть какую самую раннюю дату можем запросить. И как-то блочить возможность запрашивать даты раньше на фронте.\n* Не влезающие описания и названия облигаций\n* Перенести код настроек Дженкинса сюда\n* Может добавление бумаги сделать на беке асинхронно? Типа если свалилось с ошибкой - какое-то время еще долбится\n* Если описание не удалось достать - сходить для буржуйской бумаги за описанием бумаги еще куда-нибудь\n* Проверить, что  у купонов / дивов в разделе доход (календарь) - туда  не попадает план. И в доходе тоже\n* Зачем нам грузить именно всю историю? Для чего?\n* Наверное, стоит научиться показывать прогресс загрузки данных. И в идеале надо сначала показать типа только тикеры, а потом в отдельном потоке\n   запускать подгрузку в кеш всех остальных данных, чтобы фронт опрашивал поток и он типа отвечал что сделано, какой процент и сколько еще\n   осталось, типа сколько бумаг уже загружено, сколько в кеше. Ну и по хорошему, надо типа посмотреть сколько в среднем занимает\n   этот процесс, чисто эмпирически и примерно показывать сколько осталось времени.\n\n\n## Что надо сделать еще:\n\n* Надо что-то делать с датой, если она пуста при реализации желания\n* Убрать крипторежим\n* Убрать ненужные кнопки не с админской странички. И выключать кнопки когда не нужно (в т.ч. в диалоговых окнах)\n* В фильтрацию добавить < / > какой-то суммы, и так же добавить фильтрацию по дате\n* Привести в порядок форму парсинга csv\n* Нормальный поиск (эвент при нажатии каждой клавиши)\n* Надо подумать на хера мне вообще MainService. Что он делает?\n* Подумать над реализации Калькулятора строительства, то есть отображения как в Гугл-Таблицах\n* Надо сделать чтобы можно было сметы сохранять (типа хранение таких как бы табличек, с разными ячейками, кодом ячейки, на который можно ссылаться, ну и так далее...)\n* Возможность просматривать реализованные желания и проводить какие-то операции с ними\n* Сделать обрезку wish-name в датагриде на фронте по длине и еще и наложить ограничения при добавлении по длине\n* Надо бы обработать на беке тему с протуханием токенов (примеры я видел)\n* Сделать чтобы уже при вводе логина при редактировании пользователя осуществлялся запрос при каждом нажатии и поиск - есть такой юзер или нет\n* Домик и сайдбар почистили, но теперь \"оно\" вообще никогда не отображается.\n* Надо все правки желаний утащить в один метод\n* В перспективе надо сделать такой дашбоард с виджетом статистики. Типа добавлено в этом месяце, реализовано, удалено, изменено, добавлено на сумму и так далее....\n* Почистить код на фронте. Там пиздец просто....\n* Группы\n* Разные помники для Прома и Дева\n* Возможность переключения валюты текущей (для все бумаг и всех показателей должна быть одна валюта - все рассчеты в одной валюте)\n* Разобраться с фигней, когда переходишь на страничку - а она не отображается (выявить причины: не поднялся сервис, протух токен)\n* Вынести пользовательские методы в отдельный контроллер и сделать отдельный метод для сохранения режима получения, отдельный для получения\n* Придумать и написать тест для перемещения\n* Сделать бейдж NEW в помесячной группировке для только что добавленных желаний\n* Сделать сохранение фильтрации и сортировки для помесячной группировки\n* Сделать поиск в помесячной группировке\n* Надо убрать РеспонсЭнтити и возвращать нормальные ДТО-объекты, а не этот пиздец\n* Сделать какой-то учет текущей суммы\n* Сделать отображение текущих режимов сортировки и фильтрации\n* Вынести вкладку помесячной группировки на сайдбар\n* Добавить вкладку групп (так же вынести в сайдбар)\n* Написать тесты\n* Сейчас мы считаем просто сколько вложили за все время и делим на купоны / рост / дивы за все время. А по хорошему надо считать или за прошлый год или вообще какую-то сложную логику по годам или вообще разный подсчет выдавать, например: всего / по последнему году / по среднему / по минимальному / по максимальному.\n* Прокинуть интерцепторы\n* Общий ЭксепшнХендлер\n* Сделать само-отключение поиска\n* Нормальный DNS для сайта\n* Показывать более развернутую статистику: реализованное и все такое\n* При щелчке на желании показывать в каком оно месяце при всех видах отображения\n* Надо организовать еще списки подсчетов с исключением определенных записей (типа микро-сметы)\n* Надо чтобы нельзя было добавлять одинаковые желания\n* Написать статью на AntonRomanov.com о сервисе\n* Починить фигню с тем что надо щелкнуть, чтобы табличка подгрузилась\n* Починить фигню с 401-й странице\n* Решить тему с протухающим токеном\n* Подсмотреть как сделан шедулинг проверки протухания токена с выводом алерта.\n* Фавикон\n* Выделение и перемещение по месяцам нескольких желаний\n* Кнопочки Реализовать / Удалить / Редактировать при нажатии на желание в помесячно-групповом режиме\n* Кнопочки \"Вернуться в табличный режим\" и \"Обновить\" заменить для мобилы\n* Избавиться от $Do и всего такого.\n\n## Отдаленные планы:\n\n* Ссылки\n* Публичные списки\n* Блог\n* Чат\n* Трекер багов с номерами, чтобы не хранить это в ридми\n* Разные списки\n* Файловое облако\n\n\n\n# Вспомогательные SQL:\n\n-- Сумма мелких и важных желаний без реализованных и архивных\nselect sum(p.price) from (select * from\n  arnote.wishes w WHERE\n  (w.id NOT IN (327, 311, 326, 328, 308, 373, 299, 300, 307, 335, 303, 259, 309, 333, 331, 313, 312, 330, 304))) p\nWHERE NOT p.archive AND (p.realized=false or p.realized ISNULL );\n\n\n-- Сумма реализованного\nselect sum(p.price) from (select * from\n  arnote.wishes w WHERE\n  (w.id NOT IN (311))) p\nWHERE NOT p.archive AND (p.realized=true);\n\n\n-- Реализованное\nselect * from (select * from\n  arnote.wishes w WHERE\n  (w.id NOT IN (311))) p\nWHERE NOT p.archive AND (p.realized=true);\n\n-- Сумма реализованного (за месяц)\nselect sum(p.price) from (select * from\n  arnote.wishes w WHERE\n  (w.id NOT IN (311) and extract(month FROM w.realization_date) = 10)) p\nWHERE NOT p.archive AND (p.realized=true);\n\n-- Вьюшка для удобного представления таблицы Желания\nCREATE VIEW wishes_view_not_realized AS\n  SELECT\n    w.id,\n    w.wish,\n    w.price,\n    w.priority,\n    w.priority_group\n  FROM arnote.public.wishes AS w WHERE w.user_id = 2 AND (w.realized  = FALSE OR w.realized ISNULL) ;\n\n\n# Скрипты\n\nСкрипты для сборки проекта в облаке:\n\n**arnote.sh**\n\n#!/bin/sh\n\n# Copy arNote jar script\n\n<pre><code>\necho  \"Удаляем директорию...\"  \nsudo rm -Rfv /home/admin/arnote  \necho \"Директория удалена. Создаем заново....\"  \nsudo mkdir /home/admin/arnote  \necho \"Директория создана успешно. Копируем файлы....\"  \nsudo cp -a /var/lib/jenkins/workspace/arNote/* /home/admin/arnote/  \necho \"Подменяем properties-файл для профиля prod\"  \nsudo cp -f /home/admin/application-prod.properties /home/admin/arnote/src/main/resources/  \necho \"Пытаемся вызвать Maven и собрать проект...\"  \nsudo mvn -f /home/admin/arnote/pom.xml clean package  \necho \"Скрипт выполнен!!!\"  \n</code></pre>  \n\n**arnote-wrapper.sh**\n\n#!/bin/sh\n# Restart arNote script-wrapper\n\n<pre><code>\necho  \" * * *   REBUILD AND RESTART ARNOTE SCRIPT   * * * \"  \necho \"Пытаемся остановить unit\"  \nsudo systemctl restart arnote  \necho \"Unit успешно остановлен\"  \necho \"Пытаемся запустить скрипт удаления старых файлов и пересборки сервиса Maven'ом\"  \n. /home/admin/arnote.sh  \n\necho \"========= !!! Скрипт-wrapper успешно выполнен!!! ===========\"  \necho \"Пытемся снова запустить Unit\"  \nsudo systemctl start arnote  \necho \"Unit успешно запущен!\"  \n</code></pre>\n\n\n \n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/README.md b/README.md
--- a/README.md	(revision 3dad3e300872df570ee9156e54d007a3436343e3)
+++ b/README.md	(date 1661165607649)
@@ -1,6 +1,3 @@
-ТЕСТ ХУЕСТ БЛЯТЬ
-
-
 # arNote
 1. Сервис хранения желаний, планирования трат.
 2. Сервис анализа инвестиций
